steps:
  - script: |
      mkdir "$(Build.StagingDirectory)\publish"
      xcopy "out\windows\Installer.Windows\pkg\$(configuration)\net472\win-x86" "$(Build.StagingDirectory)\publish"
    displayName: Prepare final build artifacts

  - task: PublishPipelineArtifact@0
    displayName: Publish unsigned installer artifacts
    condition: and(succeeded(), ne(variables['SignType'], 'real'))
    inputs:
        artifactName: 'Installer.Windows.Unsigned'
        targetPath: '$(Build.StagingDirectory)\publish'

  - task: PublishPipelineArtifact@0
    displayName: Publish signed installer artifacts
    condition: and(succeeded(), eq(variables['SignType'], 'real'))
    inputs:
        artifactName: 'Installer.Windows.Signed'
        targetPath: '$(Build.StagingDirectory)\publish'
